#!/usr/bin/env coffee

fs = require 'fs'
fs.path = require 'path'
_ = require 'underscore'
_.str = require 'underscore.string'


here = (segments...) -> fs.path.join __dirname, '..', segments...
postsPath = here 'build/data/posts.json'
posts = JSON.parse fs.readFileSync postsPath
changed = no

for post in posts
    if not post.title
        post.title = _.str.humanize post.slug
        changed = yes
        console.log "Adding title to #{post.permalink}: #{post.title}"

if changed
    fs.writeFileSync postsPath, JSON.stringify posts, undefined, 2